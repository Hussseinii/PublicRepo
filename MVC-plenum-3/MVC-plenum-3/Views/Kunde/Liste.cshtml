@model List<MVC_plenum_2.Models.Kunde>


<!DOCTYPE html>

<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>Liste</title>
    <script type="text/javascript">
    $(document).ready(function () {
        // lag en hendelse som utføres når en a-href med "data-SletteModal = true" trykkes.
        $('a[data-sletteModal=true]').click(function () {

            // hent inn data-taggene fra denne a-hef lenken
            var data_navn = $(this).data('navn');
            var data_id = $(this).data('id');
            
            // legg ut dataene i div'en i modal-view'et
            $('#slettNavn').html(data_navn);

            // lag en hendelse for knappen for å slette via ajax, knappen ligger i modal-view'et
            // må ligge inne i denne overordnede funksjonen for at id'én som er valgt kan brukes
            $("#sletteModalKnapp").click(function () {
                // id som skal slettes ligger i data_id
                $.ajax({
                    url: '@Url.Action("Slett", "Kunde")',
                    data: { id: data_id },  // en parameter inn i slett(id)-metoden i kunde-kontrolleren (JSON-objekt)
                    success: function () {
                        // må kalle liste-metoden for å vise den nye listen av kunder
                        $.ajax({
                            url: '@Url.Action("Liste", "Kunde")',
                            success: function () {
                                // så må siden reloades!
                                window.location.reload();
                            }
                        });
                        }
                    });
                })
            })
        });
    </script>
</head>
<body>
 <br /><br/>
    <!-- Det er ikke nødvendig å bruke partial-view's her. Dette er bare for å illustrere dette -->
    @foreach (var kunde in Model)
    {
        @Html.Partial("ListePartial",kunde)
    }
    <a href="@Url.Action("Registrer")" class = "btn btn-success">Registrer</a>
    
    <!-- Under er et alternaiv til lenken over
        @Html.ActionLink("Registrer", "Registrer", new { tom = "" }, new { @class = "btn btn-success" })
        Lettere å forstå den øverste og den bevarer mulighetene for å flytte løsnningen ved bruk av Url.Action
    -->

    @Html.Partial("sletteModal")
</body>
</html>
